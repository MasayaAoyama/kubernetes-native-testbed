---
apiVersion: nats.io/v1alpha2
kind: NatsCluster
metadata:
  name: delivery-status-queue
  namespace: delivery-status
spec:
  size: 3
  version: "1.2.0"
  pod:
    enableConfigReload: true
  auth:
    enableServiceAccounts: true

# The ServiceAccount and NatsServiceRole definitions
# are required to have the same name in the namespace.
---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: nats-admin-user
  namespace: delivery-status
---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: nats-user
  namespace: delivery-status
---
apiVersion: nats.io/v1alpha2
kind: NatsServiceRole
metadata:
  name: nats-user
  namespace: delivery-status #nats-io

  # Specifies which NATS cluster will be mapping this account,
  # (have to create a service role with permission per cluster).
  labels:
    nats_cluster: delivery-status-queue
spec:
  permissions:
    publish: ["foo.*", "foo.bar.quux"]
    subscribe: ["foo.bar", "greetings", "hello.world"]

---
apiVersion: nats.io/v1alpha2
kind: NatsServiceRole
metadata:
  name: nats-admin-user
  namespace: delivery-status #nats-io
  labels:
    nats_cluster: delivery-status-queue
spec:
  permissions:
    publish: [">"]
    subscribe: [">"]

